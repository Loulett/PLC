Реализация dynamic_cast основана на статье Страуструпа: http://www.stroustrup.com/fast_dynamic_casting.pdf

К сожалению, пока что этот код компилируется только в стандарте 20 года, но просто посмотрите, насколько он хорош!
(Под VS не работает, под gcc работает)
